"use strict";chill_penguin.module("isotope",(()=>{let e,t={};return{initialize:()=>{e=chill_penguin.isotope,t={},e.dependency.load_all().then((()=>{e.setup()})).catch((e=>{console.error("Error loading dependencies:",e)}))},dependency:{load_all:async()=>{await Promise.all([e.dependency.load.isotope_lib(),e.dependency.load.select_all(),e.dependency.load.autocomplete()])},load:{select_all:async()=>chill_penguin.form?.select_all?Promise.resolve():await chill_penguin.util.load_javascript("/dist/codebase/chill-penguin/scripts/module.form.select-all.js"),autocomplete:async()=>chill_penguin.form?.autocomplete?Promise.resolve():await chill_penguin.util.load_javascript("/dist/codebase/chill-penguin/scripts/module.form.autocomplete.js"),isotope_lib:async()=>await chill_penguin.util.load_javascript("/wms/codebase/chill-penguin/scripts/libs/isotope-v3.0.6.min.js")}},setup:()=>{document.querySelectorAll('[data-module="isotope"]').forEach((i=>{const s=i.getAttribute("id"),o=JSON.parse(i.getAttribute("data-isotope-filters-bind-ids"))||[];t[s]={el:i,isotope_object:null,elements_container:i.querySelector("[data-module='isotope.elements-container']"),layout_mode:i.getAttribute("data-isotope-layout-mode"),sort_data_config:i.getAttribute("data-isotope-sort-data"),sort_by_id:i.getAttribute("data-isotope-sortBy-bind-id")||null,sort_by_value:null,sort_ascending_id:i.getAttribute("data-isotope-sortAscending-bind-id")||null,sort_ascending_value:!0,filter_values:[i.getAttribute("data-isotope-filter-initial")],filter_initial:i.getAttribute("data-isotope-filter-initial"),filter_no_results:i.getAttribute("data-isotope-filter-no-results"),filters:{},filter_groups_ids:JSON.parse(i.getAttribute("data-isotope-filters-bind-ids"))||[],filter_groups_key:o.map((e=>document.querySelector(`[data-isotope-filter-group][id="${e}"]`)?.getAttribute("data-isotope-filter-group")||null)),filter_groups_types:o.map((e=>document.querySelector(`[data-isotope-filter-group][id="${e}"]`)?.getAttribute("data-isotope-filter-group-type")||null)),filtered_elements_id:i.getAttribute("data-isotope-number-filtered-elements-bind-id")||null,custom_styles:JSON.parse(i.getAttribute("data-isotope-zebra-stripes"))||[],onupdate:i.getAttribute("data-isotope-onupdate-func")||!1},e.event_listeners.initialize(s),e.ui.initialize(s)}))},config:{state:{get:{sort_by:e=>t[e].sort_by_value,sort_ascending:e=>t[e].sort_ascending_value,filter:e=>t[e].filter_values,number_filtered_elements:e=>{t[e].filtered_elements_id&&document.querySelector(`#${t[e].filtered_elements_id}`)&&(document.querySelector(`#${t[e].filtered_elements_id}`).innerHTML=t[e].isotope_object.getFilteredItemElements().length)}},set:{sort_by:e=>{const{sort_by_id:i}=t[e];i&&(t[e].sort_by_value=chill_penguin.radiobutton.get_value(`#${i} > input`,"data-isotope-sort-value"))},sort_ascending:e=>{const{sort_ascending_id:i}=t[e];i&&(t[e].sort_ascending_value=JSON.parse(chill_penguin.radiobutton.get_value(`#${i} > input`,"data-isotope-sort-value")))},filter:e=>{setTimeout((()=>{const{filter_initial:i,filter_no_results:s,filter_groups_ids:o,filter_groups_key:l,filter_groups_types:r}=t[e];let n;o.length>0&&(o.forEach(((i,s)=>{t[e].filters[l[s]]=[]})),o.forEach(((i,o)=>{switch(r[o]){case"checkbox":const r=document.querySelectorAll(`#${i} input`),a=Array.from(r).every((e=>e.checked));if(n=document.querySelector(`#${i}`),a)t[e].filters[l[o]]="*";else{let r=chill_penguin.checkbox.get_values(`#${i} input`,"data-isotope-filter-value");if(n.hasAttribute("data-isotope-or-and-bind")){const e=n.getAttribute("data-isotope-or-and-bind");r="and"===chill_penguin.radiobutton.get_value(`#${e}  input`)?[r.join("")||s]:r}t[e].filters[l[o]]=[...new Set([...t[e].filters[l[o]]||[],...r])]}break;case"radiobutton":t[e].filters[l[o]]=chill_penguin.radiobutton.get_value(`#${i} input`,"data-isotope-filter-value");break;case"input_autocomplete":const c=document.querySelector(`#${i}`);c.hasAttribute("data-autocomplete-values")?"[]"===c.getAttribute("data-autocomplete-values")?t[e].filters[l[o]]=c.getAttribute("data-isotope-filter-initial")||"*":t[e].filters[l[o]]=JSON.parse(c.getAttribute("data-autocomplete-values")).map((e=>e.toLowerCase().replace(/ /g,"-"))):t[e].filters[l[o]]=c.getAttribute("data-isotope-filter-initial")||"*";break;case"switch":document.querySelectorAll(`#${i} button`);const u=Array.from(document.querySelectorAll("button[aria-checked]")).every((e=>"true"===e.getAttribute("aria-checked")));if(n=document.querySelector(`#${i}`),u)t[e].filters[l[o]]="*";else{let r=chill_penguin.button.get_values(`#${i} button`,"data-isotope-filter-value");if(n.hasAttribute("data-isotope-or-and-bind")){const e=n.getAttribute("data-isotope-or-and-bind");r="and"===chill_penguin.button.get_value(`#${e} button`)?[r.join("")||s]:r}t[e].filters[l[o]]=[...new Set([...t[e].filters[l[o]]||[],...r])]}}})),t[e].filter_values=chill_penguin.isotope.util.combine_obj_value(t[e].filters))}),0)}}}},ui:{initialize:i=>{const{layout_mode:s,filter_initial:o,sort_data_config:l,elements_container:r,onupdate:n}=t[i];e.config.state.set.sort_by(i),e.config.state.set.sort_ascending(i),e.config.state.set.filter(i);const a={itemSelector:'[data-module="isotope.element"]',layoutMode:s,getSortData:JSON.parse(l),sortBy:e.config.state.get.sort_by(i),filter:o,sortAscending:e.config.state.get.sort_ascending(i)};t[i].isotope_object=new Isotope(r,a),e.config.state.get.number_filtered_elements(i),e.ui.custom_styles(i),n&&chill_penguin.util.run_str_func(n,{id:i})},refresh:i=>{const{filter_no_results:s,onupdate:o}=t[i];setTimeout((()=>{const l={sortBy:e.config.state.get.sort_by(i),filter:e.config.state.get.filter(i).length>0?e.config.state.get.filter(i):s,sortAscending:e.config.state.get.sort_ascending(i)};t[i].isotope_object.arrange(l),e.config.state.get.number_filtered_elements(i),e.ui.custom_styles(i),o&&chill_penguin.util.run_str_func(o,{id:i}),setTimeout((()=>{chill_penguin.equalize_heights.force_resize()}),500)}),100)},refresh_all:()=>{document.querySelectorAll('[data-module="isotope"]').forEach((i=>{if(null!==i.offsetParent){const s=i.getAttribute("id");t[s]&&(e.config.state.set.sort_by(s),e.config.state.set.sort_ascending(s),e.config.state.set.filter(s),e.ui.refresh(s))}}))},rearrange_heights:()=>{document.querySelectorAll('[data-module="isotope"]').forEach((i=>{if(null!==i.offsetParent){const s=i.getAttribute("id");t[s]&&e.ui.refresh(s)}}))},custom_styles:e=>{const{isotope_object:i,custom_styles:s}=t[e],o=s[0],l=s[1];i.getItemElements().forEach((e=>{e.classList.remove(l)})),i.getFilteredItemElements().forEach(((e,t)=>{t%o==0&&e.classList.add(l)}))}},event_listeners:{initialize:t=>{e.event_listeners.sort_by(t),e.event_listeners.sort_ascending(t),e.event_listeners.filters(t),e.event_listeners.select_all(t),e.event_listeners.or_and(t)},set:{sort_by:()=>{const t=chill_penguin.util.closest_parent(event.currentTarget,'[data-module="isotope"]').getAttribute("id");e.config.state.set.sort_by(t),e.ui.refresh(t)},sort_ascending:()=>{const t=chill_penguin.util.closest_parent(event.currentTarget,'[data-module="isotope"]').getAttribute("id");e.config.state.set.sort_ascending(t),e.ui.refresh(t)},filter:()=>{const t=chill_penguin.util.closest_parent(event.currentTarget,'[data-module="isotope"]').getAttribute("id");e.config.state.set.filter(t),e.ui.refresh(t)}},sort_by:i=>{const{sort_by_id:s}=t[i];s&&document.querySelectorAll(`#${s} > input`).forEach((t=>{t.removeEventListener("click",e.event_listeners.set.sort_by),t.addEventListener("click",e.event_listeners.set.sort_by)}))},sort_ascending:i=>{const{sort_ascending_id:s}=t[i];s&&document.querySelectorAll(`#${s} > input`).forEach((t=>{t.removeEventListener("click",e.event_listeners.set.sort_ascending),t.addEventListener("click",e.event_listeners.set.sort_ascending)}))},filters:i=>{const{filter_groups_ids:s}=t[i];s.forEach((t=>{document.querySelectorAll(`#${t} input, #${t} button`).forEach((t=>{t.removeEventListener("click",e.event_listeners.set.filter),t.addEventListener("click",e.event_listeners.set.filter)}))}))},select_all:i=>{const{el:s}=t[i];s.querySelectorAll('[data-module="select-all"]').forEach((t=>{const i=t.getAttribute("data-select-all-bind");s.querySelector(`#${i} > input[data-module='select-all.all']`).removeEventListener("click",e.event_listeners.set.filter),s.querySelector(`#${i} > input[data-module='select-all.all']`).addEventListener("click",e.event_listeners.set.filter),s.querySelector(`#${i} > input[data-module='select-all.none']`).removeEventListener("click",e.event_listeners.set.filter),s.querySelector(`#${i} > input[data-module='select-all.none']`).addEventListener("click",e.event_listeners.set.filter)}))},or_and:i=>{const{el:s}=t[i];s.querySelectorAll('[data-module="select-all"]').forEach((t=>{if(t.getAttribute("data-isotope-or-and-bind")){const i=t.getAttribute("data-isotope-or-and-bind");s.querySelector(`#${i} > input[data-module='isotope.or']`).removeEventListener("click",e.event_listeners.set.filter),s.querySelector(`#${i} > input[data-module='isotope.or']`).addEventListener("click",e.event_listeners.set.filter),s.querySelector(`#${i} > input[data-module='isotope.and']`).removeEventListener("click",e.event_listeners.set.filter),s.querySelector(`#${i} > input[data-module='isotope.and']`).addEventListener("click",e.event_listeners.set.filter)}}))}},util:{combine_obj_value:e=>{const t=Object.values(e);if(t.every((e=>"*"===e)))return"*";return t.reduce(((e,t)=>"*"===t?e:Array.isArray(t)?e.flatMap((e=>t.map((t=>`${e}${t}`)))):e.map((e=>`${e}${t}`))),[""]).join(",")}}}}));